[default]

exten => validate_cdr_value,1,NoOp()
 same => n,ExecIf($[${ISNULL(${ARG4})}]?Set(actual=${CDR(${ARG1})}):Set(actual=${CDR(${ARG1},${ARG4})}))
 same => n,GoSub(default,${ARG3},1(${ARG2},${actual}))
 same => n,ExecIf($[${GOSUB_RETVAL}=0]?UserEvent(Failure,Field: ${ARG1},Test: ${ARG3},Expected: ${ARG2},Actual: ${actual}))
 same => n,Return()

exten => test_equals,1,NoOp()
 same => n,ExecIf($["${ARG1}"="${ARG2}"]?Return(1):Return(0))

exten => test_not_null,1,NoOp()
 same => n,ExecIf($[${ISNULL(${ARG2})}]?Return(0):Return(1))

exten => test_fp_not_zero,1,NoOp()
 same => n,Set(integer=${CUT(ARG2,".",1)})
 same => n,Set(fractional=${CUT(ARG2,".",2)})
 same => n,ExecIf($["${integer}"="0" || ${ISNULL(${integer})}]?Return(0))
 same => n,ExecIf($["${fractional}"="000000" || ${ISNULL(${fractional})}]?Return(0))
 same => n,Return(1)

exten => s,1,NoOp()
 same => n,Set(CALLERID(name)=Alice)
 same => n,Set(CALLERID(num)=8005551234)
 same => n,Set(CDR(foo)=bar)
 same => n,Set(CDR(userfield)=test)
 same => n,Wait(1)
 same => n,Answer()
 same => n,Wait(1)
 same => n,Hangup()

exten => h,1,NoOp()
 same => n,GoSub(default,validate_cdr_value,1(lastdata,,test_equals))
 same => n,GoSub(default,validate_cdr_value,1(disposition,ANSWERED,test_equals))
 same => n,GoSub(default,validate_cdr_value,1(src,8005551234,test_equals))
 same => n,GoSub(default,validate_cdr_value,1(start,,test_not_null))
 same => n,GoSub(default,validate_cdr_value,1(start,,test_fp_not_zero,u))
 same => n,GoSub(default,validate_cdr_value,1(dst,s,test_equals))
 same => n,GoSub(default,validate_cdr_value,1(answer,,test_not_null))
 same => n,GoSub(default,validate_cdr_value,1(answer,,test_fp_not_zero,u))
 same => n,GoSub(default,validate_cdr_value,1(dcontext,default,test_equals))
 same => n,GoSub(default,validate_cdr_value,1(end,,test_not_null))
 same => n,GoSub(default,validate_cdr_value,1(end,,test_fp_not_zero,u))
 same => n,GoSub(default,validate_cdr_value,1(uniqueid,,test_not_null))
 same => n,GoSub(default,validate_cdr_value,1(dstchannel,,test_equals))
 same => n,GoSub(default,validate_cdr_value,1(duration,,test_not_null))
 same => n,GoSub(default,validate_cdr_value,1(duration,,test_fp_not_zero,f))
 same => n,GoSub(default,validate_cdr_value,1(userfield,test,test_equals))
 same => n,GoSub(default,validate_cdr_value,1(lastapp,Hangup,test_equals))
 same => n,GoSub(default,validate_cdr_value,1(billsec,,test_not_null))
 same => n,GoSub(default,validate_cdr_value,1(billsec,,test_fp_not_zero,f))
 same => n,GoSub(default,validate_cdr_value,1(channel,,test_not_null))
 same => n,GoSub(default,validate_cdr_value,1(sequence,1,test_equals))
 same => n,GoSub(default,validate_cdr_value,1(foo,bar,test_equals))
 same => n,Set(CDR(foo)=not_bar)
 same => n,GoSub(default,validate_cdr_value,1(foo,not_bar,test_equals))
